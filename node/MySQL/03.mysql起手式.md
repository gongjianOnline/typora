# mysql起手式

## 连接本地数据库

```sql
mysql -uroot -pxxx;
```

## 库操作

### 创建

```sql
create database dbname charset utf8;
```

### 进入库

```sql
use dbname;
```

### 查看格式

```sql
show create database dbname;
```

### 删除库

```sql
drop database id exists dbname;
```

### 执行 sql 文件创建数据库

创建一个 `sql.sql` 文件

```sql
create database dbname charset utf8;
use dbname;
```

执行创建脚本

```sql
mysql -uroot -p < sql.sql;
```

## 表操作

### 创建表

```sql
create table class (id int PRIMARY KEY AUTO_INCREMENT,cname varchar(10) not null,description varchar(100) null);
```

### 修改表名

```sql
/*方式一*/
alter table student rename stu;
/*方式二*/
rename 他变了 student to stu;
```



### 查看表字段类型

```sql
desc class
```

### 删除表

```sql
drop table if exists class
```

### 复制表

```sql
/*方式一*/
create table test like class; /*依赖 class 字段类型创建 test 表*/
desc test;
insert into test select * from class; /*将 class 表的全部数据插入到 test 表*/
insert info test(cname) select cname from class; /*指定 cname 字段从 class 表中插入到 test*/

/*方式二*/
create table a select * from class; /*快捷方式,创建 a 表 直接将 class 表的数据复制到 a 中*/
/*创建 b 表和相关字段, 将指定的 class 表中的 cname 字段数据复制到 b 表中*/
create table b (id in int PRIMARY KEY AUTO_INCREMENT,cname varchar(10) not null) select cname from class;
```

## 字段操作

### 修改字段类型

```sql
alter table student modify name varchar(10) not null; /*修改 student 表的 name 字段为 varchar 类型 不为空*/
```

### 修改字段名称

```sql
alter table student change name sname char(30) not null; /*修改 student 表中的 name 字段名为 sname 类型是char不为空*/
```

### 添加字段

``` sql
alter table student add sex smallint default null; /*添加 sex 字段*/
alter table student add email varchar(50) default null after id; /*添加 email 字段 位置放在 id 之后*/
alter table student add qq varchar(20) default null first; /*添加 qq 字段,位置在最上方*/
```

### 删除字段

```sql
alter table student drop qq; /*删除qq字段*/
```

### 主键操作

```sql
/*需要修改主键特性后再删除*/
alter table student modify id int not null;
alter table student drop primary key;
/*添加主键*/
alter table stu add primary key (id);
/*设置为自增*/
alter table modify id int not null auto_increment;
```

## 数据操作

### 简单添加

```sql
/*方式一*/
INSERT INTO class set cname="测试",decript="描述";
/*方式二*/
INSERT INTO class (cname,descript) VALUES ("测试1","描述1"),("测试2","描述2")
```

### 查询数据

```sql
select * from class; /*查询 class 表的全部数据*/
select Id,cname from class; /*查询 class 中 id 和 cname 字段的数据*/
select id,cname as name from class; /*将 cname 别名为 name*/
select * from class where cname like "%p%";/*查找 class 表中 cname 字段中包含 p 的*/
select * from student where age>=20 AND name like "%xio%"; /*查询 age >= 20 并且 name 中包含 xio 的数据*/
select * from student where age>=20 OR name like "%xio%"; /*查询 age >= 20 或者 name 中包含 xio 的数据*/
select * from student where class_id in (1,2); /*查询 class_id 在 (1,2) 之间的数据*/
select * from student where class_id not in (1,2); /*查询 class_id 在 (1,2) 不在之间的数据*/
select * from student where class_id is null; /*查询 class_id 字段为空的数据*/
select * from student where class_is is not null; /*查询 class_id 字段不为空的数据*/
select name,if(class_id,class_id,"未分配") from student; /*查询 student 表中的 name 和 class_id字段,如果 class_id 是null,则替换为 '未分配'*/
select name,ifnull(class_id,"未分配") from student; /*同上的语法糖*/
```

关键字 **not**  代表反向

### 排序数据

```sql
select * from student order by age asc; /*根据 age 降序*/
select * from student order by age desc; /*根据 age 升序*/
select * from student order by class_id asc,age asc; /*当 class_id 出现相同的时候,根据 age 字段排序*/
```

### 更新数据

```sql
update student set class_id=3 where age>20; /*将 student 表中的 age>20 的 class_id 改为 3*/
```

### 删除数据

```sql
delete from student where name='xioami';
```

