# 02. express 操作 mongoDB

## 安装

```shell
npm install mongoose -S
```

## 连接数据库

创建 config / db.config.js

```javascript
const mongoose = require("mongoose")
// 会自动创建并连接 test 数据库
mongoose.connect("mongodb://localhost:27017/test")
```

bin / www 文件

```javascript
require("../config/db.config.js")
```

## 创建数据模型

创建 modle / usermodle.js

```javascript
const mongoose = require("mongoose")
const Schmea = mongoose.Schmea
const UserType = {
    username:String,
    password:String,
    age:Number
}
// 模型中 user 数据库中会自动创建 "users" 集合, 库中的命名规则是"模型+s"
const UserModel = mongoose.modle("user",new Schmea(UserType))
module.expres = UserModel
```

API层应用

```javascript
const express = require("express")
const UserModel = require("./modle/usermodle.js")
const app = express()
app.get("/login",(request,response)=>{
    let data = request.query;
    UserModel.create({
        username:data.username,
        password:data.password,
        age:data.age
    }).then((data)=>{
        console.log(data)
        response.send({
            code:101,
            magess:"写入成功"
        })
    })
})
app.litsen(3000,()=>{console.log("启动成功")})
```

