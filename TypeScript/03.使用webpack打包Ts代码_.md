

## 目录结构

[![rsmJs0.png](https://s3.ax1x.com/2020/12/22/rsmJs0.png)](https://imgchr.com/i/rsmJs0)

## 安装

```node
npm i -D webpack webpack-cli typescript ts-loader html-webpack-plugin  webpack-dev-server  clean-webpack-plugin
```

## 配置

### 配置webpack

在项目根目录新建webpack.config.js

```javascript
// 引入一个包
const path = require("path");
// 引入html插件,打包时自动生成html文件,并引入js
const HTMLWebpackPlugin = require("html-webpack-plugin")
// 引入clean插件,首先把dist文件清空,然后重新生成
const {CleanWebpackPlugin} = require('clean-webpack-plugin')

// webpack 中的所有配置信息都应该写在module.exports中
module.exports = {
  //指定入口文件
  entry:"./src/index.ts",
  //指定打包文件所在的目录
  output:{
    //指定打包后的目录
    path:path.resolve(__dirname,'dist'),
    // 打包后文件的名字
    filename:"bundle.js"
  },
  //指定webpack打包时要使用的模块
  module:{
    //指定加载的规则
    rules:[
      {
        // test指定的是规则生效的文件
        test:/\.ts$/,
        //要是用的loader
        use:'ts-loader',
        //要排除的文件
        exclude:/node-modules/
      }
    ]
  },
  // 配置webpack插件
  plugins:[
    new HTMLWebpackPlugin({
      // title:'自定义网页title',
      //生成网页模板
      template:"./src/index.html"
    }),
    new CleanWebpackPlugin()
  ],
  //用来设置引用模块
  resolve:{
    //扩展名,凡是以ts和js结尾的文件,都可以作为模块使用
    extensions: ['.ts','.js']
  }
}
```

---



### 配置tsconfig.json

在项目根目录中新建tsconfig.json文件

````json
{
  "compilerOptions": {
    "module": "ES2015",
    "target": "ES2015",
    "strict": true
  }
}
````

---

## 运行&打包

在package.json中配置

```json	
"scripts": {
    "build": "webpack",
    "start": "webpack serve --port 8888"
  },
```

运行

```javascript
npm run start / yarn start
```

打包

```node
npm run build / yarn build
```

---

## 浏览器兼容配置

### 安装babel

```javascript
npm install -D @babel/core @babel/preset-env babel-loader core-js
```

### 配置babel

在webpack.config.js中配置

```json
module.exports = {
    output:{
        // 告诉webpack不使用箭头
        environment:{
            arrowFunction:false
        }
    },
    module:{
        //指定加载的规则
        rules:[
            {
             	// test指定的是规则生效的文件
              	test:/\.ts$/,
                // 要用的loader
                use:[
                    //配置babel
                    {
                        // 指定加载器
                        loader:"babel-loader",
                        // 配置babel
                        options:{
                            //设置预定义的环境
                            presets:[
                                [
                                    //指定环境插件
                                    "@babel/preset-env",
                                    //配置信息
                                    {
                                        //需要兼容目标的浏览器
                                        targets:{
                                            // "浏览器":"浏览器版本"
                                            "chrome":"88",
                                            "ie":"11"
                                        },
                                        //指定corejs的版本
                                        "corejs":"3",
                                        //使用corejs的方式"usage",表示按需加载
                                        "useBuiliIns":"usage"
                                    }
                                ]
                            ]
                        }
                    },
                    "ts-loader"
                ]
            }
        ]
    }
}
```

